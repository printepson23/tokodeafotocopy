<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>DEA FOTOCOPY</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{box-sizing:border-box}
body{font-family:Arial;margin:0;background:#f1f5f9;padding-top:260px}
header{position:fixed;top:0;left:0;width:100%;background:#0f172a;color:#fff;z-index:1000}
.header-inner{max-width:900px;margin:auto;padding:12px;text-align:center}
.menu{display:flex;flex-wrap:wrap;justify-content:center;gap:6px;margin-top:8px}
.menu button{background:#1e293b;color:#fff;border:none;padding:6px 10px;border-radius:8px;font-size:12px}
.menu .wa{background:#25D366}
section{max-width:900px;margin:auto;padding:16px}
.card{background:#fff;padding:6px 10px;margin-bottom:6px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,.1)}
.row{display:flex;align-items:center;gap:8px}
button{border:none;border-radius:6px;padding:6px 10px;font-weight:bold;cursor:pointer}
.green{background:#22c55e;color:#fff}
.red{background:#fee2e2;color:#991b1b}
.hidden{display:none}
#adminPanel{display:none;position:fixed;top:60px;left:50%;transform:translateX(-50%);background:#fff;padding:14px;border-radius:12px;z-index:2000;width:260px}
</style>
</head>
<body>

<header>
  <div class="header-inner">
    <h2 id="judul">üè™ DEA FOTOCOPY</h2>
    <small>ATK ‚Ä¢ Print ‚Ä¢ Fotokopi ‚Ä¢ Scan</small>
    <nav class="menu">
      <button onclick="tab('print')">üñ®Ô∏è Print</button>
      <button onclick="tab('produk')">üõí Produk</button>
      <button onclick="tab('keranjang')">üßæ Keranjang</button>
      <button class="wa" onclick="orderWA()">üí¨ WA</button>
    </nav>
  </div>
</header>

<section id="login">
  <div class="card">
    <input id="username" placeholder="Nama pelanggan">
    <button class="green" onclick="login()">Masuk</button>
  </div>
</section>

<section id="app" class="hidden">

<div id="tab-print">
  <div class="card">
    <select id="ptype">
      <option value="1000">Hitam Putih (Rp1.000)</option>
      <option value="2000">Warna (Rp2.000)</option>
    </select>
    <input id="pqty" type="number" placeholder="Jumlah">
    <button class="green" onclick="addPrint()">Tambah</button>
  </div>
</div>

<div id="tab-produk" class="hidden">
  <div id="productList"></div>
</div>

<div id="tab-keranjang" class="hidden">
  <div id="cart"></div>
  <b id="total">Total: Rp0</b>
</div>

</section>

<!-- ADMIN -->
<div id="adminPanel">
  <input id="pname" placeholder="Nama Produk">
  <input id="pprice" type="number" placeholder="Harga">
  <button class="green" onclick="addProduct()">Tambah Produk</button>
  <button class="red" onclick="adminPanel.style.display='none'">Tutup</button>
</div>

<script>
const WA="6285808949204";
let user="",cart=[],total=0;

function login(){
  user=username.value;
  if(!user) return alert("Isi nama");
  login.classList?.add("hidden");
  document.getElementById("login").classList.add("hidden");
  document.getElementById("app").classList.remove("hidden");
  listenProducts();
}

function tab(t){
  document.querySelectorAll('[id^="tab"]').forEach(x=>x.classList.add("hidden"));
  document.getElementById("tab-"+t).classList.remove("hidden");
}

function addItem(n,p){cart.push({n,p});total+=p;renderCart()}
function addPrint(){
  const q=+pqty.value,p=+ptype.value;
  if(!q)return;
  cart.push({n:"Print",p:p*q});total+=p*q;renderCart()
}
function renderCart(){
  cart.innerHTML="";
  document.getElementById("cart").innerHTML=cart.map(i=>`
    <div class="row"><div style="flex:1">${i.n}</div><div>Rp${i.p.toLocaleString("id-ID")}</div></div>
  `).join("");
  totalEl.textContent="Total: Rp"+total.toLocaleString("id-ID");
}
function orderWA(){
  let m=`Halo saya ${user}%0A`;
  cart.forEach(i=>m+=`- ${i.n} Rp${i.p}%0A`);
  window.open(`https://wa.me/${WA}?text=${m}`);
}
let c=0;
judul.onclick=()=>{if(++c>=5&&prompt("Admin?")==="1234")adminPanel.style.display="block",c=0}
</script>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyApYGa1HWEzjWFSWXlqZefi6D0TGKtHa7I",
  authDomain: "dea-fotocopy-6e46b.firebaseapp.com",
  projectId: "dea-fotocopy-6e46b",
  storageBucket: "dea-fotocopy-6e46b.firebasestorage.app",
  messagingSenderId: "497872933662",
  appId: "1:497872933662:web:e58285619fb3b810f3ef0f"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const list=document.getElementById("productList");

window.listenProducts=()=>{
  onSnapshot(collection(db,"products"),snap=>{
    list.innerHTML="";
    let n=1;
    snap.forEach(d=>{
      const p=d.data();
      list.innerHTML+=`
      <div class="card row">
        <div>${n++}.</div>
        <div style="flex:1">${p.name}</div>
        <div>Rp${p.price.toLocaleString("id-ID")}</div>
        <button class="green" onclick="addItem('${p.name}',${p.price})">+</button>
      </div>`;
    });
  });
};

window.addProduct=async()=>{
  await addDoc(collection(db,"products"),{
    name:pname.value,
    price:+pprice.value
  });
  pname.value="";pprice.value="";
};
</script>

</body>
</html>
